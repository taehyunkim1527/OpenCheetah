Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 1997799
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomBN #1 via element-wise mult on 25600 points
[31m4 ==> 0[0m
[31mElemWiseSecretVectorMult Output Mismatch[0m
Time in sec for current matmul = 0.211
2048 => 0
[31mMatMul Output Mismatch[0m
Relu #1 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.706
Truncate #1 on 25600 points by 12 bits
Time in sec for current matmul = 10.279
1024 => -65236811113
[31mMatMul Output Mismatch[0m
Relu #3 on 25600 points, truncate=1 by 12 bits
Time in sec for current relu = 0.857
Maxpool 1 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=50
Time in sec for current maxpool = 34.576
Time in sec for current matmul = 0.359
3701351810 => -44003151714
[31mMatMul Output Mismatch[0m
Relu #5 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.716
Truncate #2 on 25600 points by 12 bits
Time in sec for current matmul = 10.343
1024 => -20408089960
[31mMatMul Output Mismatch[0m
Relu #7 on 25600 points, truncate=1 by 12 bits
Time in sec for current relu = 0.857
Maxpool 2 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=50
Time in sec for current maxpool = 34.57
Time in sec for current matmul = 0.36
6285820064 => 52209867432
[31mMatMul Output Mismatch[0m
Relu #9 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.716
Thread i = 0, total data sent till now = 55187982
Thread i = 1, total data sent till now = 3478759
Thread i = 2, total data sent till now = 2168087
Thread i = 3, total data sent till now = 3478759
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 99352025 microseconds.
Total data sent = 54.4901 MiB.
Number of rounds = 1487
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 0 seconds.
Total time in MatMul = 21.552 seconds.
Total time in BatchNorm = 0.521 seconds.
Total time in Truncation = 2.555 seconds.
Total time in Relu = 3.852 seconds.
Total time in MaxPool = 69.146 seconds.
Total time in AvgPool = 0 seconds.
Total time in ArgMax = 0 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 0 MiB.
MatMul data sent = 49.0545 MiB.
BatchNorm data sent = 1.25022 MiB.
Truncation data sent = 1.38483 MiB.
Relu data sent = 1.42783 MiB.
Maxpool data sent = 1.37274 MiB.
Avgpool data sent = 0 MiB.
ArgMax data sent = 0 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
12746550
12746550
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746550
12746550
12746550
12746550
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746550
12746551
12746551
12746551
12746550
12746550
12746550
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746550
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746550
12746551
12746550
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746550
12746550
12746551
12746551
12746551
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746550
12746550
12746550
12746551
12746551
12746551
12746550
12746550
12746550
12746550
12746551
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746550
12746550
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746550
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746550
12746550
12746551
12746551
12746550
12746551
12746551
12746550
12746550
12746551
12746550
12746551
12746551
12746550
12746550
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746550
12746550
12746550
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746550
12746551
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746550
12746550
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746550
12746551
12746550
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746550
12746550
12746550
12746551
12746550
12746551
12746551
12746551
12746550
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746550
12746550
12746551
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746550
12746550
12746551
12746550
12746551
12746550
12746551
12746551
12746550
12746550
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746550
12746550
12746551
12746551
12746550
12746551
12746551
12746551
12746551
12746551
12746551
12746551
12746550
12746551
12746551
12746550
Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 1997778
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomBN #1 via element-wise mult on 25600 points
[31m4 ==> 0[0m
[31mElemWiseSecretVectorMult Output Mismatch[0m
Time in sec for current matmul = 0.204
2048 => 0
[31mMatMul Output Mismatch[0m
Relu #1 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.706
Truncate #1 on 25600 points by 12 bits
Time in sec for current matmul = 10.151
1024 => -66107407940
[31mMatMul Output Mismatch[0m
Relu #3 on 25600 points, truncate=1 by 12 bits
Time in sec for current relu = 0.858
Maxpool 1 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=50
Time in sec for current maxpool = 34.57
Time in sec for current matmul = 0.362
6000123486 => -733277624
[31mMatMul Output Mismatch[0m
Relu #5 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.715
Truncate #2 on 25600 points by 12 bits
Time in sec for current matmul = 10.244
1024 => -10943921732
[31mMatMul Output Mismatch[0m
Relu #7 on 25600 points, truncate=1 by 12 bits
Time in sec for current relu = 0.855
Maxpool 2 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=50
Time in sec for current maxpool = 34.562
Time in sec for current matmul = 0.362
5221398230 => 31792305580
[31mMatMul Output Mismatch[0m
Relu #9 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.716
Thread i = 0, total data sent till now = 55188851
Thread i = 1, total data sent till now = 3478759
Thread i = 2, total data sent till now = 2168087
Thread i = 3, total data sent till now = 3478759
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 99094278 microseconds.
Total data sent = 54.491 MiB.
Number of rounds = 1487
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 0 seconds.
Total time in MatMul = 21.323 seconds.
Total time in BatchNorm = 0.52 seconds.
Total time in Truncation = 2.552 seconds.
Total time in Relu = 3.85 seconds.
Total time in MaxPool = 69.132 seconds.
Total time in AvgPool = 0 seconds.
Total time in ArgMax = 0 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 0 MiB.
MatMul data sent = 49.0555 MiB.
BatchNorm data sent = 1.25004 MiB.
Truncation data sent = 1.38483 MiB.
Relu data sent = 1.42783 MiB.
Maxpool data sent = 1.37274 MiB.
Avgpool data sent = 0 MiB.
ArgMax data sent = 0 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
7761795
7761794
7761794
7761795
7761794
7761795
7761795
7761795
7761794
7761794
7761795
7761794
7761794
7761794
7761795
7761794
7761794
7761795
7761794
7761795
7761795
7761794
7761794
7761794
7761794
7761795
7761795
7761794
7761795
7761795
7761795
7761794
7761795
7761794
7761795
7761795
7761794
7761795
7761795
7761795
7761794
7761794
7761794
7761795
7761794
7761795
7761795
7761795
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761794
7761795
7761795
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761794
7761795
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761795
7761794
7761795
7761794
7761795
7761795
7761794
7761795
7761794
7761794
7761795
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761795
7761795
7761795
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761795
7761794
7761794
7761795
7761794
7761795
7761795
7761795
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761795
7761795
7761795
7761794
7761794
7761794
7761795
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761795
7761795
7761794
7761795
7761795
7761794
7761795
7761795
7761795
7761795
7761795
7761794
7761794
7761795
7761794
7761795
7761795
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761794
7761795
7761795
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761795
7761795
7761795
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761795
7761795
7761795
7761794
7761795
7761795
7761794
7761794
7761795
7761794
7761794
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761795
7761794
7761794
7761794
7761795
7761795
7761794
7761795
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761794
7761794
7761795
7761795
7761795
7761794
7761795
7761795
7761794
7761795
7761795
7761795
7761795
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761795
7761794
7761795
7761795
7761794
7761795
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761795
7761795
7761794
7761794
7761795
7761795
7761795
7761794
7761795
7761794
7761795
7761794
7761795
7761795
7761795
7761794
7761794
7761794
7761795
7761795
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761795
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761795
7761795
7761795
7761794
7761795
7761795
7761794
7761794
7761794
7761795
7761794
7761795
7761794
7761794
7761794
7761795
7761795
7761794
7761795
7761795
7761795
7761795
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761794
7761794
7761794
7761794
7761795
7761795
7761794
7761794
7761794
7761794
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761794
7761795
7761794
7761794
7761794
7761795
7761795
7761795
7761794
7761795
7761795
7761794
7761795
7761795
7761795
7761795
7761795
7761795
7761794
7761794
7761795
7761794
7761794
7761795
7761795
7761794
7761794
7761795
7761794
7761795
7761795
7761794
