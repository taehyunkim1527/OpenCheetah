Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 1997782
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomBN #1 via element-wise mult on 51200 points
[31m4 ==> 0[0m
[31mElemWiseSecretVectorMult Output Mismatch[0m
Time in sec for current matmul = 0.212
2048 => 0
[31mMatMul Output Mismatch[0m
Relu #1 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.705
Truncate #1 on 51200 points by 12 bits
Time in sec for current matmul = 20.468
1024 => -49441208842
[31mMatMul Output Mismatch[0m
Relu #3 on 51200 points, truncate=1 by 12 bits
Time in sec for current relu = 0.944
Maxpool 1 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=100
Time in sec for current maxpool = 69.874
Time in sec for current matmul = 0.361
5917429474 => 9413463318
[31mMatMul Output Mismatch[0m
Relu #5 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.716
Truncate #2 on 51200 points by 12 bits
Time in sec for current matmul = 20.4
1024 => 37196334582
[31mMatMul Output Mismatch[0m
Relu #7 on 51200 points, truncate=1 by 12 bits
Time in sec for current relu = 0.94
Maxpool 2 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=100
Time in sec for current maxpool = 69.873
Time in sec for current matmul = 0.361
6093027262 => 23635870288
[31mMatMul Output Mismatch[0m
Relu #9 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.715
Thread i = 0, total data sent till now = 106692385
Thread i = 1, total data sent till now = 5224359
Thread i = 2, total data sent till now = 2608087
Thread i = 3, total data sent till now = 5224359
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 191027594 microseconds.
Total data sent = 107.358 MiB.
Number of rounds = 2887
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 0 seconds.
Total time in MatMul = 41.802 seconds.
Total time in BatchNorm = 0.816 seconds.
Total time in Truncation = 2.79 seconds.
Total time in Relu = 4.02 seconds.
Total time in MaxPool = 139.747 seconds.
Total time in AvgPool = 0 seconds.
Total time in ArgMax = 0 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 0 MiB.
MatMul data sent = 96.6818 MiB.
BatchNorm data sent = 2.32178 MiB.
Truncation data sent = 2.76727 MiB.
Relu data sent = 2.81332 MiB.
Maxpool data sent = 2.7735 MiB.
Avgpool data sent = 0 MiB.
ArgMax data sent = 0 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770478
5770477
5770477
5770477
5770478
5770477
5770478
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770478
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770478
5770478
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770478
5770477
5770477
5770478
5770477
5770477
5770478
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770478
5770477
5770478
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770478
5770477
5770477
5770477
5770478
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770478
5770477
5770478
5770477
5770477
5770478
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770478
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770478
5770478
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770478
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770478
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
5770477
Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 1997784
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomBN #1 via element-wise mult on 51200 points
[31m4 ==> 0[0m
[31mElemWiseSecretVectorMult Output Mismatch[0m
Time in sec for current matmul = 0.208
2048 => -1
[31mMatMul Output Mismatch[0m
Relu #1 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.706
Truncate #1 on 51200 points by 12 bits
Time in sec for current matmul = 20.419
1024 => 38711283290
[31mMatMul Output Mismatch[0m
Relu #3 on 51200 points, truncate=1 by 12 bits
Time in sec for current relu = 0.934
Maxpool 1 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=100
Time in sec for current maxpool = 69.853
Time in sec for current matmul = 0.359
5454483568 => 38853088384
[31mMatMul Output Mismatch[0m
Relu #5 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.716
Truncate #2 on 51200 points by 12 bits
Time in sec for current matmul = 20.466
1024 => -5043696038
[31mMatMul Output Mismatch[0m
Relu #7 on 51200 points, truncate=1 by 12 bits
Time in sec for current relu = 0.937
Maxpool 2 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=100
Time in sec for current maxpool = 69.879
Time in sec for current matmul = 0.357
15451652332 => -17284320880
[31mMatMul Output Mismatch[0m
Relu #9 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.716
Thread i = 0, total data sent till now = 106691595
Thread i = 1, total data sent till now = 5224359
Thread i = 2, total data sent till now = 2608087
Thread i = 3, total data sent till now = 5224359
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 191015772 microseconds.
Total data sent = 107.357 MiB.
Number of rounds = 2887
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 0 seconds.
Total time in MatMul = 41.809 seconds.
Total time in BatchNorm = 0.821 seconds.
Total time in Truncation = 2.787 seconds.
Total time in Relu = 4.009 seconds.
Total time in MaxPool = 139.732 seconds.
Total time in AvgPool = 0 seconds.
Total time in ArgMax = 0 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 0 MiB.
MatMul data sent = 96.681 MiB.
BatchNorm data sent = 2.32181 MiB.
Truncation data sent = 2.76727 MiB.
Relu data sent = 2.81332 MiB.
Maxpool data sent = 2.7735 MiB.
Avgpool data sent = 0 MiB.
ArgMax data sent = 0 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
-1
