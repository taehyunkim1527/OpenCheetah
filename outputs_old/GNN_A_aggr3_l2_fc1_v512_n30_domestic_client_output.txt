Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 1997821
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomBN #1 via element-wise mult on 15360 points
[31m4 ==> 0[0m
[31mElemWiseSecretVectorMult Output Mismatch[0m
Time in sec for current matmul = 0.078
2048 => -1
[31mMatMul Output Mismatch[0m
Relu #1 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.145
Truncate #1 on 15360 points by 12 bits
Time in sec for current matmul = 2.442
1024 => -52175505778
[31mMatMul Output Mismatch[0m
Relu #3 on 15360 points, truncate=1 by 12 bits
Time in sec for current relu = 0.196
Maxpool 1 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=30
Time in sec for current maxpool = 4.214
Time in sec for current matmul = 0.111
5679912884 => 60844457462
[31mMatMul Output Mismatch[0m
Relu #5 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.156
Truncate #2 on 15360 points by 12 bits
Time in sec for current matmul = 2.422
1024 => 24597034638
[31mMatMul Output Mismatch[0m
Relu #7 on 15360 points, truncate=1 by 12 bits
Time in sec for current relu = 0.191
Maxpool 2 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=30
Time in sec for current maxpool = 4.225
Time in sec for current matmul = 0.112
21320616382 => 48891548261
[31mMatMul Output Mismatch[0m
Relu #9 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.155
Thread i = 0, total data sent till now = 34474160
Thread i = 1, total data sent till now = 2780519
Thread i = 2, total data sent till now = 1992087
Thread i = 3, total data sent till now = 2780519
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 15723746 microseconds.
Total data sent = 33.2362 MiB.
Number of rounds = 927
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 0 seconds.
Total time in MatMul = 5.165 seconds.
Total time in BatchNorm = 0.111 seconds.
Total time in Truncation = 0.574 seconds.
Total time in Relu = 0.843 seconds.
Total time in MaxPool = 8.439 seconds.
Total time in AvgPool = 0 seconds.
Total time in ArgMax = 0 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 0 MiB.
MatMul data sent = 30.0039 MiB.
BatchNorm data sent = 0.714472 MiB.
Truncation data sent = 0.831848 MiB.
Relu data sent = 0.873627 MiB.
Maxpool data sent = 0.812439 MiB.
Avgpool data sent = 0 MiB.
ArgMax data sent = 0 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
11936414
11936415
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936415
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936415
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936415
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936415
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936414
11936415
11936414
11936414
11936415
11936414
11936414
11936414
11936415
11936414
11936414
11936414
11936414
11936414
11936414
Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 1997809
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomBN #1 via element-wise mult on 15360 points
[31m4 ==> 0[0m
[31mElemWiseSecretVectorMult Output Mismatch[0m
Time in sec for current matmul = 0.082
2048 => -1
[31mMatMul Output Mismatch[0m
Relu #1 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.146
Truncate #1 on 15360 points by 12 bits
Time in sec for current matmul = 2.395
1024 => 15671064714
[31mMatMul Output Mismatch[0m
Relu #3 on 15360 points, truncate=1 by 12 bits
Time in sec for current relu = 0.191
Maxpool 1 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=30
Time in sec for current maxpool = 4.22
Time in sec for current matmul = 0.106
4924149170 => -62786648872
[31mMatMul Output Mismatch[0m
Relu #5 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.155
Truncate #2 on 15360 points by 12 bits
Time in sec for current matmul = 2.44
1024 => -23386294134
[31mMatMul Output Mismatch[0m
Relu #7 on 15360 points, truncate=1 by 12 bits
Time in sec for current relu = 0.19
Maxpool 2 called N=512, H=1, W=1, C=1, ksizeH=1, ksizeW=30
Time in sec for current maxpool = 4.218
Time in sec for current matmul = 0.108
4741101666 => 13167172318
[31mMatMul Output Mismatch[0m
Relu #9 on 512 points, truncate=1 by 12 bits
Time in sec for current relu = 0.156
Thread i = 0, total data sent till now = 34474601
Thread i = 1, total data sent till now = 2780519
Thread i = 2, total data sent till now = 1992087
Thread i = 3, total data sent till now = 2780519
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 15675909 microseconds.
Total data sent = 33.2367 MiB.
Number of rounds = 927
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 0 seconds.
Total time in MatMul = 5.131 seconds.
Total time in BatchNorm = 0.11 seconds.
Total time in Truncation = 0.571 seconds.
Total time in Relu = 0.838 seconds.
Total time in MaxPool = 8.438 seconds.
Total time in AvgPool = 0 seconds.
Total time in ArgMax = 0 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 0 MiB.
MatMul data sent = 30.0044 MiB.
BatchNorm data sent = 0.714404 MiB.
Truncation data sent = 0.831848 MiB.
Relu data sent = 0.873627 MiB.
Maxpool data sent = 0.812439 MiB.
Avgpool data sent = 0 MiB.
ArgMax data sent = 0 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
3214642
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214642
3214642
3214642
3214643
3214643
3214643
3214642
3214642
3214642
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214642
3214642
3214643
3214643
3214642
3214642
3214642
3214642
3214642
3214643
3214642
3214643
3214643
3214643
3214642
3214642
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214642
3214643
3214642
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214642
3214642
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214642
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214642
3214643
3214643
3214643
3214643
3214642
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214642
3214642
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214642
3214643
3214643
3214642
3214642
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214642
3214642
3214643
3214643
3214642
3214643
3214642
3214643
3214642
3214642
3214643
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214642
3214642
3214642
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214642
3214642
3214643
3214643
3214642
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214642
3214643
3214643
3214642
3214643
3214642
3214642
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214642
3214643
3214643
3214643
3214642
3214643
3214642
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214642
3214642
3214642
3214643
3214642
3214643
3214643
3214643
3214642
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214642
3214642
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214642
3214643
3214643
3214642
3214642
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214642
3214643
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214643
3214642
3214643
3214642
3214642
3214642
3214643
3214643
3214642
3214643
3214643
3214643
3214642
3214643
3214643
3214643
3214643
3214643
3214642
3214642
3214643
3214642
3214642
3214642
3214643
3214643
3214643
3214642
3214643
3214642
3214643
